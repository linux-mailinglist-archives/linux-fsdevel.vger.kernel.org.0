Return-Path: <linux-fsdevel+bounces-72168-lists+linux-fsdevel=lfdr.de@vger.kernel.org>
X-Original-To: lists+linux-fsdevel@lfdr.de
Delivered-To: lists+linux-fsdevel@lfdr.de
Received: from sea.lore.kernel.org (sea.lore.kernel.org [172.234.253.10])
	by mail.lfdr.de (Postfix) with ESMTPS id 4221ECE6942
	for <lists+linux-fsdevel@lfdr.de>; Mon, 29 Dec 2025 12:43:47 +0100 (CET)
Received: from smtp.subspace.kernel.org (conduit.subspace.kernel.org [100.90.174.1])
	by sea.lore.kernel.org (Postfix) with ESMTP id 34303300E035
	for <lists+linux-fsdevel@lfdr.de>; Mon, 29 Dec 2025 11:42:35 +0000 (UTC)
Received: from localhost.localdomain (localhost.localdomain [127.0.0.1])
	by smtp.subspace.kernel.org (Postfix) with ESMTP id 5A2042EE5F4;
	Mon, 29 Dec 2025 11:42:33 +0000 (UTC)
X-Original-To: linux-fsdevel@vger.kernel.org
Received: from www262.sakura.ne.jp (www262.sakura.ne.jp [202.181.97.72])
	(using TLSv1.2 with cipher ECDHE-RSA-AES256-GCM-SHA384 (256/256 bits))
	(No client certificate requested)
	by smtp.subspace.kernel.org (Postfix) with ESMTPS id D286E30101F
	for <linux-fsdevel@vger.kernel.org>; Mon, 29 Dec 2025 11:42:27 +0000 (UTC)
Authentication-Results: smtp.subspace.kernel.org; arc=none smtp.client-ip=202.181.97.72
ARC-Seal:i=1; a=rsa-sha256; d=subspace.kernel.org; s=arc-20240116;
	t=1767008552; cv=none; b=rOJVpX1h/E2Ss9t/UHBURileZuNFiKPxg+pTOtQv4fr4u9lIbeePLX5CV5/H213lG/z+oHnbJftEqMzKJFLL9QSbZBGXJ21hMRRp08fWXIWQhzR3hrRodIwnJFt1VsMh80GZtQ/Uh1IMqNpLvtvWH80Qy2ToJegNk9ETjplUq9c=
ARC-Message-Signature:i=1; a=rsa-sha256; d=subspace.kernel.org;
	s=arc-20240116; t=1767008552; c=relaxed/simple;
	bh=koQP4IEiD5KGAfyPhcKhUv7zDyHzyeDHokkr5FEWGEo=;
	h=Content-Type:Message-ID:Date:MIME-Version:To:From:Subject; b=imfTWKceoNaRDN1akxXAO9BuO5DesZ7t/Lu7x/P6LOHaADpvhb23RBhsIayuETmAVclVwNeADyPQwgO25wF91Jio82kMijh9E+MAK23PhrbxKnyRlhIQpO0VBQYZcxdPa6gANJ6nRi6C2HYb1nC5J/4TujnrY+Y1U8rAlEd12ns=
ARC-Authentication-Results:i=1; smtp.subspace.kernel.org; dmarc=none (p=none dis=none) header.from=I-love.SAKURA.ne.jp; spf=pass smtp.mailfrom=I-love.SAKURA.ne.jp; arc=none smtp.client-ip=202.181.97.72
Authentication-Results: smtp.subspace.kernel.org; dmarc=none (p=none dis=none) header.from=I-love.SAKURA.ne.jp
Authentication-Results: smtp.subspace.kernel.org; spf=pass smtp.mailfrom=I-love.SAKURA.ne.jp
Received: from www262.sakura.ne.jp (localhost [127.0.0.1])
	by www262.sakura.ne.jp (8.15.2/8.15.2) with ESMTP id 5BTBgG7X027158;
	Mon, 29 Dec 2025 20:42:16 +0900 (JST)
	(envelope-from penguin-kernel@I-love.SAKURA.ne.jp)
Received: from [192.168.1.10] (M106072142033.v4.enabler.ne.jp [106.72.142.33])
	(authenticated bits=0)
	by www262.sakura.ne.jp (8.15.2/8.15.2) with ESMTPSA id 5BTBgGbj027154
	(version=TLSv1.2 cipher=AES256-GCM-SHA384 bits=256 verify=NO);
	Mon, 29 Dec 2025 20:42:16 +0900 (JST)
	(envelope-from penguin-kernel@I-love.SAKURA.ne.jp)
Content-Type: multipart/mixed; boundary="------------mUQdbcsdKCm0jM2cAkKW91iu"
Message-ID: <8ce587c5-bc3e-4fc9-b00d-0af3589e2b5a@I-love.SAKURA.ne.jp>
Date: Mon, 29 Dec 2025 20:42:14 +0900
Precedence: bulk
X-Mailing-List: linux-fsdevel@vger.kernel.org
List-Id: <linux-fsdevel.vger.kernel.org>
List-Subscribe: <mailto:linux-fsdevel+subscribe@vger.kernel.org>
List-Unsubscribe: <mailto:linux-fsdevel+unsubscribe@vger.kernel.org>
MIME-Version: 1.0
User-Agent: Mozilla Thunderbird
Content-Language: en-US
To: Viacheslav Dubeyko <slava@dubeyko.com>,
        John Paul Adrian Glaubitz <glaubitz@physik.fu-berlin.de>,
        Yangtao Li <frank.li@vivo.com>,
        linux-fsdevel <linux-fsdevel@vger.kernel.org>
From: Tetsuo Handa <penguin-kernel@I-love.SAKURA.ne.jp>
Subject: [PATCH] hfsplus: pretend special inodes as regular files
X-Virus-Status: clean
X-Anti-Virus-Server: fsav105.rs.sakura.ne.jp

This is a multi-part message in MIME format.
--------------mUQdbcsdKCm0jM2cAkKW91iu
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 7bit

syzbot is reporting that hfsplus_system_read_inode() from hfsplus_iget()
 from hfsplus_btree_open() from hfsplus_fill_super() succeeds with
inode->i_mode == 0, for hfsplus_system_read_inode() does not call
hfsplus_get_perms() for updating inode->i_mode value.

Reported-by: syzbot <syzbot+895c23f6917da440ed0d@syzkaller.appspotmail.com>
Closes: https://syzkaller.appspot.com/bug?extid=895c23f6917da440ed0d
Signed-off-by: Tetsuo Handa <penguin-kernel@I-love.SAKURA.ne.jp>
---
 fs/hfsplus/super.c | 1 +
 1 file changed, 1 insertion(+)

diff --git a/fs/hfsplus/super.c b/fs/hfsplus/super.c
index aaffa9e060a0..82e0bf066e3b 100644
--- a/fs/hfsplus/super.c
+++ b/fs/hfsplus/super.c
@@ -52,6 +52,7 @@ static int hfsplus_system_read_inode(struct inode *inode)
 	default:
 		return -EIO;
 	}
+	inode->i_mode = S_IFREG;
 
 	return 0;
 }
-- 
2.47.3
--------------mUQdbcsdKCm0jM2cAkKW91iu
Content-Type: text/plain; charset=UTF-8; name="repro.c"
Content-Disposition: attachment; filename="repro.c"
Content-Transfer-Encoding: base64

Ly8gYXV0b2dlbmVyYXRlZCBieSBzeXprYWxsZXIgKGh0dHBzOi8vZ2l0aHViLmNvbS9nb29n
bGUvc3l6a2FsbGVyKQoKI2RlZmluZSBfR05VX1NPVVJDRQoKI2luY2x1ZGUgPGVuZGlhbi5o
PgojaW5jbHVkZSA8ZXJybm8uaD4KI2luY2x1ZGUgPGZjbnRsLmg+CiNpbmNsdWRlIDxzZXRq
bXAuaD4KI2luY2x1ZGUgPHN0ZGJvb2wuaD4KI2luY2x1ZGUgPHN0ZGRlZi5oPgojaW5jbHVk
ZSA8c3RkaW50Lmg+CiNpbmNsdWRlIDxzdGRpby5oPgojaW5jbHVkZSA8c3RkbGliLmg+CiNp
bmNsdWRlIDxzdHJpbmcuaD4KI2luY2x1ZGUgPHN5cy9pb2N0bC5oPgojaW5jbHVkZSA8c3lz
L21tYW4uaD4KI2luY2x1ZGUgPHN5cy9tb3VudC5oPgojaW5jbHVkZSA8c3lzL3N0YXQuaD4K
I2luY2x1ZGUgPHN5cy9zeXNjYWxsLmg+CiNpbmNsdWRlIDxzeXMvdHlwZXMuaD4KI2luY2x1
ZGUgPHVuaXN0ZC5oPgoKI2luY2x1ZGUgPGxpbnV4L2xvb3AuaD4KCiNpZm5kZWYgX19OUl9t
ZW1mZF9jcmVhdGUKI2RlZmluZSBfX05SX21lbWZkX2NyZWF0ZSAzMTkKI2VuZGlmCgpzdGF0
aWMgdW5zaWduZWQgbG9uZyBsb25nIHByb2NpZDsKCi8vJSBUaGlzIGNvZGUgaXMgZGVyaXZl
ZCBmcm9tIHB1ZmYue2MsaH0sIGZvdW5kIGluIHRoZSB6bGliIGRldmVsb3BtZW50LiBUaGUK
Ly8lIG9yaWdpbmFsIGZpbGVzIGNvbWUgd2l0aCB0aGUgZm9sbG93aW5nIGNvcHlyaWdodCBu
b3RpY2U6CgovLyUgQ29weXJpZ2h0IChDKSAyMDAyLTIwMTMgTWFyayBBZGxlciwgYWxsIHJp
Z2h0cyByZXNlcnZlZAovLyUgdmVyc2lvbiAyLjMsIDIxIEphbiAyMDEzCi8vJSBUaGlzIHNv
ZnR3YXJlIGlzIHByb3ZpZGVkICdhcy1pcycsIHdpdGhvdXQgYW55IGV4cHJlc3Mgb3IgaW1w
bGllZAovLyUgd2FycmFudHkuICBJbiBubyBldmVudCB3aWxsIHRoZSBhdXRob3IgYmUgaGVs
ZCBsaWFibGUgZm9yIGFueSBkYW1hZ2VzCi8vJSBhcmlzaW5nIGZyb20gdGhlIHVzZSBvZiB0
aGlzIHNvZnR3YXJlLgovLyUgUGVybWlzc2lvbiBpcyBncmFudGVkIHRvIGFueW9uZSB0byB1
c2UgdGhpcyBzb2Z0d2FyZSBmb3IgYW55IHB1cnBvc2UsCi8vJSBpbmNsdWRpbmcgY29tbWVy
Y2lhbCBhcHBsaWNhdGlvbnMsIGFuZCB0byBhbHRlciBpdCBhbmQgcmVkaXN0cmlidXRlIGl0
Ci8vJSBmcmVlbHksIHN1YmplY3QgdG8gdGhlIGZvbGxvd2luZyByZXN0cmljdGlvbnM6Ci8v
JSAxLiBUaGUgb3JpZ2luIG9mIHRoaXMgc29mdHdhcmUgbXVzdCBub3QgYmUgbWlzcmVwcmVz
ZW50ZWQ7IHlvdSBtdXN0IG5vdAovLyUgICAgY2xhaW0gdGhhdCB5b3Ugd3JvdGUgdGhlIG9y
aWdpbmFsIHNvZnR3YXJlLiBJZiB5b3UgdXNlIHRoaXMgc29mdHdhcmUKLy8lICAgIGluIGEg
cHJvZHVjdCwgYW4gYWNrbm93bGVkZ21lbnQgaW4gdGhlIHByb2R1Y3QgZG9jdW1lbnRhdGlv
biB3b3VsZCBiZQovLyUgICAgYXBwcmVjaWF0ZWQgYnV0IGlzIG5vdCByZXF1aXJlZC4KLy8l
IDIuIEFsdGVyZWQgc291cmNlIHZlcnNpb25zIG11c3QgYmUgcGxhaW5seSBtYXJrZWQgYXMg
c3VjaCwgYW5kIG11c3Qgbm90IGJlCi8vJSAgICBtaXNyZXByZXNlbnRlZCBhcyBiZWluZyB0
aGUgb3JpZ2luYWwgc29mdHdhcmUuCi8vJSAzLiBUaGlzIG5vdGljZSBtYXkgbm90IGJlIHJl
bW92ZWQgb3IgYWx0ZXJlZCBmcm9tIGFueSBzb3VyY2UgZGlzdHJpYnV0aW9uLgovLyUgTWFy
ayBBZGxlciAgICBtYWRsZXJAYWx1bW5pLmNhbHRlY2guZWR1CgovLyUgQkVHSU4gQ09ERSBE
RVJJVkVEIEZST00gcHVmZi57YyxofQoKI2RlZmluZSBNQVhCSVRTIDE1CiNkZWZpbmUgTUFY
TENPREVTIDI4NgojZGVmaW5lIE1BWERDT0RFUyAzMAojZGVmaW5lIE1BWENPREVTIChNQVhM
Q09ERVMgKyBNQVhEQ09ERVMpCiNkZWZpbmUgRklYTENPREVTIDI4OAoKc3RydWN0IHB1ZmZf
c3RhdGUgewogIHVuc2lnbmVkIGNoYXIqIG91dDsKICB1bnNpZ25lZCBsb25nIG91dGxlbjsK
ICB1bnNpZ25lZCBsb25nIG91dGNudDsKICBjb25zdCB1bnNpZ25lZCBjaGFyKiBpbjsKICB1
bnNpZ25lZCBsb25nIGlubGVuOwogIHVuc2lnbmVkIGxvbmcgaW5jbnQ7CiAgaW50IGJpdGJ1
ZjsKICBpbnQgYml0Y250OwogIGptcF9idWYgZW52Owp9OwpzdGF0aWMgaW50IHB1ZmZfYml0
cyhzdHJ1Y3QgcHVmZl9zdGF0ZSogcywgaW50IG5lZWQpCnsKICBsb25nIHZhbCA9IHMtPmJp
dGJ1ZjsKICB3aGlsZSAocy0+Yml0Y250IDwgbmVlZCkgewogICAgaWYgKHMtPmluY250ID09
IHMtPmlubGVuKQogICAgICBsb25nam1wKHMtPmVudiwgMSk7CiAgICB2YWwgfD0gKGxvbmcp
KHMtPmluW3MtPmluY250KytdKSA8PCBzLT5iaXRjbnQ7CiAgICBzLT5iaXRjbnQgKz0gODsK
ICB9CiAgcy0+Yml0YnVmID0gKGludCkodmFsID4+IG5lZWQpOwogIHMtPmJpdGNudCAtPSBu
ZWVkOwogIHJldHVybiAoaW50KSh2YWwgJiAoKDFMIDw8IG5lZWQpIC0gMSkpOwp9CnN0YXRp
YyBpbnQgcHVmZl9zdG9yZWQoc3RydWN0IHB1ZmZfc3RhdGUqIHMpCnsKICBzLT5iaXRidWYg
PSAwOwogIHMtPmJpdGNudCA9IDA7CiAgaWYgKHMtPmluY250ICsgNCA+IHMtPmlubGVuKQog
ICAgcmV0dXJuIDI7CiAgdW5zaWduZWQgbGVuID0gcy0+aW5bcy0+aW5jbnQrK107CiAgbGVu
IHw9IHMtPmluW3MtPmluY250KytdIDw8IDg7CiAgaWYgKHMtPmluW3MtPmluY250KytdICE9
ICh+bGVuICYgMHhmZikgfHwKICAgICAgcy0+aW5bcy0+aW5jbnQrK10gIT0gKCh+bGVuID4+
IDgpICYgMHhmZikpCiAgICByZXR1cm4gLTI7CiAgaWYgKHMtPmluY250ICsgbGVuID4gcy0+
aW5sZW4pCiAgICByZXR1cm4gMjsKICBpZiAocy0+b3V0Y250ICsgbGVuID4gcy0+b3V0bGVu
KQogICAgcmV0dXJuIDE7CiAgZm9yICg7IGxlbi0tOyBzLT5vdXRjbnQrKywgcy0+aW5jbnQr
KykgewogICAgaWYgKHMtPmluW3MtPmluY250XSkKICAgICAgcy0+b3V0W3MtPm91dGNudF0g
PSBzLT5pbltzLT5pbmNudF07CiAgfQogIHJldHVybiAwOwp9CnN0cnVjdCBwdWZmX2h1ZmZt
YW4gewogIHNob3J0KiBjb3VudDsKICBzaG9ydCogc3ltYm9sOwp9OwpzdGF0aWMgaW50IHB1
ZmZfZGVjb2RlKHN0cnVjdCBwdWZmX3N0YXRlKiBzLCBjb25zdCBzdHJ1Y3QgcHVmZl9odWZm
bWFuKiBoKQp7CiAgaW50IGZpcnN0ID0gMDsKICBpbnQgaW5kZXggPSAwOwogIGludCBiaXRi
dWYgPSBzLT5iaXRidWY7CiAgaW50IGxlZnQgPSBzLT5iaXRjbnQ7CiAgaW50IGNvZGUgPSBm
aXJzdCA9IGluZGV4ID0gMDsKICBpbnQgbGVuID0gMTsKICBzaG9ydCogbmV4dCA9IGgtPmNv
dW50ICsgMTsKICB3aGlsZSAoMSkgewogICAgd2hpbGUgKGxlZnQtLSkgewogICAgICBjb2Rl
IHw9IGJpdGJ1ZiAmIDE7CiAgICAgIGJpdGJ1ZiA+Pj0gMTsKICAgICAgaW50IGNvdW50ID0g
Km5leHQrKzsKICAgICAgaWYgKGNvZGUgLSBjb3VudCA8IGZpcnN0KSB7CiAgICAgICAgcy0+
Yml0YnVmID0gYml0YnVmOwogICAgICAgIHMtPmJpdGNudCA9IChzLT5iaXRjbnQgLSBsZW4p
ICYgNzsKICAgICAgICByZXR1cm4gaC0+c3ltYm9sW2luZGV4ICsgKGNvZGUgLSBmaXJzdCld
OwogICAgICB9CiAgICAgIGluZGV4ICs9IGNvdW50OwogICAgICBmaXJzdCArPSBjb3VudDsK
ICAgICAgZmlyc3QgPDw9IDE7CiAgICAgIGNvZGUgPDw9IDE7CiAgICAgIGxlbisrOwogICAg
fQogICAgbGVmdCA9IChNQVhCSVRTICsgMSkgLSBsZW47CiAgICBpZiAobGVmdCA9PSAwKQog
ICAgICBicmVhazsKICAgIGlmIChzLT5pbmNudCA9PSBzLT5pbmxlbikKICAgICAgbG9uZ2pt
cChzLT5lbnYsIDEpOwogICAgYml0YnVmID0gcy0+aW5bcy0+aW5jbnQrK107CiAgICBpZiAo
bGVmdCA+IDgpCiAgICAgIGxlZnQgPSA4OwogIH0KICByZXR1cm4gLTEwOwp9CnN0YXRpYyBp
bnQgcHVmZl9jb25zdHJ1Y3Qoc3RydWN0IHB1ZmZfaHVmZm1hbiogaCwgY29uc3Qgc2hvcnQq
IGxlbmd0aCwgaW50IG4pCnsKICBpbnQgbGVuOwogIGZvciAobGVuID0gMDsgbGVuIDw9IE1B
WEJJVFM7IGxlbisrKQogICAgaC0+Y291bnRbbGVuXSA9IDA7CiAgaW50IHN5bWJvbDsKICBm
b3IgKHN5bWJvbCA9IDA7IHN5bWJvbCA8IG47IHN5bWJvbCsrKQogICAgKGgtPmNvdW50W2xl
bmd0aFtzeW1ib2xdXSkrKzsKICBpZiAoaC0+Y291bnRbMF0gPT0gbikKICAgIHJldHVybiAw
OwogIGludCBsZWZ0ID0gMTsKICBmb3IgKGxlbiA9IDE7IGxlbiA8PSBNQVhCSVRTOyBsZW4r
KykgewogICAgbGVmdCA8PD0gMTsKICAgIGxlZnQgLT0gaC0+Y291bnRbbGVuXTsKICAgIGlm
IChsZWZ0IDwgMCkKICAgICAgcmV0dXJuIGxlZnQ7CiAgfQogIHNob3J0IG9mZnNbTUFYQklU
UyArIDFdOwogIG9mZnNbMV0gPSAwOwogIGZvciAobGVuID0gMTsgbGVuIDwgTUFYQklUUzsg
bGVuKyspCiAgICBvZmZzW2xlbiArIDFdID0gb2Zmc1tsZW5dICsgaC0+Y291bnRbbGVuXTsK
ICBmb3IgKHN5bWJvbCA9IDA7IHN5bWJvbCA8IG47IHN5bWJvbCsrKQogICAgaWYgKGxlbmd0
aFtzeW1ib2xdICE9IDApCiAgICAgIGgtPnN5bWJvbFtvZmZzW2xlbmd0aFtzeW1ib2xdXSsr
XSA9IHN5bWJvbDsKICByZXR1cm4gbGVmdDsKfQpzdGF0aWMgaW50IHB1ZmZfY29kZXMoc3Ry
dWN0IHB1ZmZfc3RhdGUqIHMsIGNvbnN0IHN0cnVjdCBwdWZmX2h1ZmZtYW4qIGxlbmNvZGUs
CiAgICAgICAgICAgICAgICAgICAgICBjb25zdCBzdHJ1Y3QgcHVmZl9odWZmbWFuKiBkaXN0
Y29kZSkKewogIHN0YXRpYyBjb25zdCBzaG9ydCBsZW5zWzI5XSA9IHszLCAgNCwgIDUsICA2
LCAgIDcsICAgOCwgICA5LCAgIDEwLCAgMTEsIDEzLAogICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAxNSwgMTcsIDE5LCAyMywgIDI3LCAgMzEsICAzNSwgIDQzLCAgNTEsIDU5
LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA2NywgODMsIDk5LCAxMTUsIDEz
MSwgMTYzLCAxOTUsIDIyNywgMjU4fTsKICBzdGF0aWMgY29uc3Qgc2hvcnQgbGV4dFsyOV0g
PSB7MCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMSwgMSwgMSwgMSwgMiwgMiwgMiwKICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgMiwgMywgMywgMywgMywgNCwgNCwgNCwgNCwg
NSwgNSwgNSwgNSwgMH07CiAgc3RhdGljIGNvbnN0IHNob3J0IGRpc3RzWzMwXSA9IHsKICAg
ICAgMSwgICAgMiwgICAgMywgICAgNCwgICAgNSwgICAgNywgICAgOSwgICAgMTMsICAgIDE3
LCAgICAyNSwKICAgICAgMzMsICAgNDksICAgNjUsICAgOTcsICAgMTI5LCAgMTkzLCAgMjU3
LCAgMzg1LCAgIDUxMywgICA3NjksCiAgICAgIDEwMjUsIDE1MzcsIDIwNDksIDMwNzMsIDQw
OTcsIDYxNDUsIDgxOTMsIDEyMjg5LCAxNjM4NSwgMjQ1Nzd9OwogIHN0YXRpYyBjb25zdCBz
aG9ydCBkZXh0WzMwXSA9IHswLCAwLCAwLCAgMCwgIDEsICAxLCAgMiwgIDIsICAzLCAgMywK
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgNCwgNCwgNSwgIDUsICA2LCAgNiwg
IDcsICA3LCAgOCwgIDgsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDksIDks
IDEwLCAxMCwgMTEsIDExLCAxMiwgMTIsIDEzLCAxM307CiAgaW50IHN5bWJvbDsKICBkbyB7
CiAgICBzeW1ib2wgPSBwdWZmX2RlY29kZShzLCBsZW5jb2RlKTsKICAgIGlmIChzeW1ib2wg
PCAwKQogICAgICByZXR1cm4gc3ltYm9sOwogICAgaWYgKHN5bWJvbCA8IDI1NikgewogICAg
ICBpZiAocy0+b3V0Y250ID09IHMtPm91dGxlbikKICAgICAgICByZXR1cm4gMTsKICAgICAg
aWYgKHN5bWJvbCkKICAgICAgICBzLT5vdXRbcy0+b3V0Y250XSA9IHN5bWJvbDsKICAgICAg
cy0+b3V0Y250Kys7CiAgICB9IGVsc2UgaWYgKHN5bWJvbCA+IDI1NikgewogICAgICBzeW1i
b2wgLT0gMjU3OwogICAgICBpZiAoc3ltYm9sID49IDI5KQogICAgICAgIHJldHVybiAtMTA7
CiAgICAgIGludCBsZW4gPSBsZW5zW3N5bWJvbF0gKyBwdWZmX2JpdHMocywgbGV4dFtzeW1i
b2xdKTsKICAgICAgc3ltYm9sID0gcHVmZl9kZWNvZGUocywgZGlzdGNvZGUpOwogICAgICBp
ZiAoc3ltYm9sIDwgMCkKICAgICAgICByZXR1cm4gc3ltYm9sOwogICAgICB1bnNpZ25lZCBk
aXN0ID0gZGlzdHNbc3ltYm9sXSArIHB1ZmZfYml0cyhzLCBkZXh0W3N5bWJvbF0pOwogICAg
ICBpZiAoZGlzdCA+IHMtPm91dGNudCkKICAgICAgICByZXR1cm4gLTExOwogICAgICBpZiAo
cy0+b3V0Y250ICsgbGVuID4gcy0+b3V0bGVuKQogICAgICAgIHJldHVybiAxOwogICAgICB3
aGlsZSAobGVuLS0pIHsKICAgICAgICBpZiAoZGlzdCA8PSBzLT5vdXRjbnQgJiYgcy0+b3V0
W3MtPm91dGNudCAtIGRpc3RdKQogICAgICAgICAgcy0+b3V0W3MtPm91dGNudF0gPSBzLT5v
dXRbcy0+b3V0Y250IC0gZGlzdF07CiAgICAgICAgcy0+b3V0Y250Kys7CiAgICAgIH0KICAg
IH0KICB9IHdoaWxlIChzeW1ib2wgIT0gMjU2KTsKICByZXR1cm4gMDsKfQpzdGF0aWMgaW50
IHB1ZmZfZml4ZWQoc3RydWN0IHB1ZmZfc3RhdGUqIHMpCnsKICBzdGF0aWMgaW50IHZpcmdp
biA9IDE7CiAgc3RhdGljIHNob3J0IGxlbmNudFtNQVhCSVRTICsgMV0sIGxlbnN5bVtGSVhM
Q09ERVNdOwogIHN0YXRpYyBzaG9ydCBkaXN0Y250W01BWEJJVFMgKyAxXSwgZGlzdHN5bVtN
QVhEQ09ERVNdOwogIHN0YXRpYyBzdHJ1Y3QgcHVmZl9odWZmbWFuIGxlbmNvZGUsIGRpc3Rj
b2RlOwogIGlmICh2aXJnaW4pIHsKICAgIGxlbmNvZGUuY291bnQgPSBsZW5jbnQ7CiAgICBs
ZW5jb2RlLnN5bWJvbCA9IGxlbnN5bTsKICAgIGRpc3Rjb2RlLmNvdW50ID0gZGlzdGNudDsK
ICAgIGRpc3Rjb2RlLnN5bWJvbCA9IGRpc3RzeW07CiAgICBzaG9ydCBsZW5ndGhzW0ZJWExD
T0RFU107CiAgICBpbnQgc3ltYm9sOwogICAgZm9yIChzeW1ib2wgPSAwOyBzeW1ib2wgPCAx
NDQ7IHN5bWJvbCsrKQogICAgICBsZW5ndGhzW3N5bWJvbF0gPSA4OwogICAgZm9yICg7IHN5
bWJvbCA8IDI1Njsgc3ltYm9sKyspCiAgICAgIGxlbmd0aHNbc3ltYm9sXSA9IDk7CiAgICBm
b3IgKDsgc3ltYm9sIDwgMjgwOyBzeW1ib2wrKykKICAgICAgbGVuZ3Roc1tzeW1ib2xdID0g
NzsKICAgIGZvciAoOyBzeW1ib2wgPCBGSVhMQ09ERVM7IHN5bWJvbCsrKQogICAgICBsZW5n
dGhzW3N5bWJvbF0gPSA4OwogICAgcHVmZl9jb25zdHJ1Y3QoJmxlbmNvZGUsIGxlbmd0aHMs
IEZJWExDT0RFUyk7CiAgICBmb3IgKHN5bWJvbCA9IDA7IHN5bWJvbCA8IE1BWERDT0RFUzsg
c3ltYm9sKyspCiAgICAgIGxlbmd0aHNbc3ltYm9sXSA9IDU7CiAgICBwdWZmX2NvbnN0cnVj
dCgmZGlzdGNvZGUsIGxlbmd0aHMsIE1BWERDT0RFUyk7CiAgICB2aXJnaW4gPSAwOwogIH0K
ICByZXR1cm4gcHVmZl9jb2RlcyhzLCAmbGVuY29kZSwgJmRpc3Rjb2RlKTsKfQpzdGF0aWMg
aW50IHB1ZmZfZHluYW1pYyhzdHJ1Y3QgcHVmZl9zdGF0ZSogcykKewogIHN0YXRpYyBjb25z
dCBzaG9ydCBvcmRlclsxOV0gPSB7MTYsIDE3LCAxOCwgMCwgOCwgIDcsIDksICA2LCAxMCwg
NSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDExLCA0LCAgMTIsIDMsIDEz
LCAyLCAxNCwgMSwgMTV9OwogIGludCBubGVuID0gcHVmZl9iaXRzKHMsIDUpICsgMjU3Owog
IGludCBuZGlzdCA9IHB1ZmZfYml0cyhzLCA1KSArIDE7CiAgaW50IG5jb2RlID0gcHVmZl9i
aXRzKHMsIDQpICsgNDsKICBpZiAobmxlbiA+IE1BWExDT0RFUyB8fCBuZGlzdCA+IE1BWERD
T0RFUykKICAgIHJldHVybiAtMzsKICBzaG9ydCBsZW5ndGhzW01BWENPREVTXTsKICBpbnQg
aW5kZXg7CiAgZm9yIChpbmRleCA9IDA7IGluZGV4IDwgbmNvZGU7IGluZGV4KyspCiAgICBs
ZW5ndGhzW29yZGVyW2luZGV4XV0gPSBwdWZmX2JpdHMocywgMyk7CiAgZm9yICg7IGluZGV4
IDwgMTk7IGluZGV4KyspCiAgICBsZW5ndGhzW29yZGVyW2luZGV4XV0gPSAwOwogIHNob3J0
IGxlbmNudFtNQVhCSVRTICsgMV0sIGxlbnN5bVtNQVhMQ09ERVNdOwogIHN0cnVjdCBwdWZm
X2h1ZmZtYW4gbGVuY29kZSA9IHtsZW5jbnQsIGxlbnN5bX07CiAgaW50IGVyciA9IHB1ZmZf
Y29uc3RydWN0KCZsZW5jb2RlLCBsZW5ndGhzLCAxOSk7CiAgaWYgKGVyciAhPSAwKQogICAg
cmV0dXJuIC00OwogIGluZGV4ID0gMDsKICB3aGlsZSAoaW5kZXggPCBubGVuICsgbmRpc3Qp
IHsKICAgIGludCBzeW1ib2w7CiAgICBpbnQgbGVuOwogICAgc3ltYm9sID0gcHVmZl9kZWNv
ZGUocywgJmxlbmNvZGUpOwogICAgaWYgKHN5bWJvbCA8IDApCiAgICAgIHJldHVybiBzeW1i
b2w7CiAgICBpZiAoc3ltYm9sIDwgMTYpCiAgICAgIGxlbmd0aHNbaW5kZXgrK10gPSBzeW1i
b2w7CiAgICBlbHNlIHsKICAgICAgbGVuID0gMDsKICAgICAgaWYgKHN5bWJvbCA9PSAxNikg
ewogICAgICAgIGlmIChpbmRleCA9PSAwKQogICAgICAgICAgcmV0dXJuIC01OwogICAgICAg
IGxlbiA9IGxlbmd0aHNbaW5kZXggLSAxXTsKICAgICAgICBzeW1ib2wgPSAzICsgcHVmZl9i
aXRzKHMsIDIpOwogICAgICB9IGVsc2UgaWYgKHN5bWJvbCA9PSAxNykKICAgICAgICBzeW1i
b2wgPSAzICsgcHVmZl9iaXRzKHMsIDMpOwogICAgICBlbHNlCiAgICAgICAgc3ltYm9sID0g
MTEgKyBwdWZmX2JpdHMocywgNyk7CiAgICAgIGlmIChpbmRleCArIHN5bWJvbCA+IG5sZW4g
KyBuZGlzdCkKICAgICAgICByZXR1cm4gLTY7CiAgICAgIHdoaWxlIChzeW1ib2wtLSkKICAg
ICAgICBsZW5ndGhzW2luZGV4KytdID0gbGVuOwogICAgfQogIH0KICBpZiAobGVuZ3Roc1sy
NTZdID09IDApCiAgICByZXR1cm4gLTk7CiAgZXJyID0gcHVmZl9jb25zdHJ1Y3QoJmxlbmNv
ZGUsIGxlbmd0aHMsIG5sZW4pOwogIGlmIChlcnIgJiYgKGVyciA8IDAgfHwgbmxlbiAhPSBs
ZW5jb2RlLmNvdW50WzBdICsgbGVuY29kZS5jb3VudFsxXSkpCiAgICByZXR1cm4gLTc7CiAg
c2hvcnQgZGlzdGNudFtNQVhCSVRTICsgMV0sIGRpc3RzeW1bTUFYRENPREVTXTsKICBzdHJ1
Y3QgcHVmZl9odWZmbWFuIGRpc3Rjb2RlID0ge2Rpc3RjbnQsIGRpc3RzeW19OwogIGVyciA9
IHB1ZmZfY29uc3RydWN0KCZkaXN0Y29kZSwgbGVuZ3RocyArIG5sZW4sIG5kaXN0KTsKICBp
ZiAoZXJyICYmIChlcnIgPCAwIHx8IG5kaXN0ICE9IGRpc3Rjb2RlLmNvdW50WzBdICsgZGlz
dGNvZGUuY291bnRbMV0pKQogICAgcmV0dXJuIC04OwogIHJldHVybiBwdWZmX2NvZGVzKHMs
ICZsZW5jb2RlLCAmZGlzdGNvZGUpOwp9CnN0YXRpYyBpbnQgcHVmZih1bnNpZ25lZCBjaGFy
KiBkZXN0LCB1bnNpZ25lZCBsb25nKiBkZXN0bGVuLAogICAgICAgICAgICAgICAgY29uc3Qg
dW5zaWduZWQgY2hhciogc291cmNlLCB1bnNpZ25lZCBsb25nIHNvdXJjZWxlbikKewogIHN0
cnVjdCBwdWZmX3N0YXRlIHMgPSB7CiAgICAgIC5vdXQgPSBkZXN0LAogICAgICAub3V0bGVu
ID0gKmRlc3RsZW4sCiAgICAgIC5vdXRjbnQgPSAwLAogICAgICAuaW4gPSBzb3VyY2UsCiAg
ICAgIC5pbmxlbiA9IHNvdXJjZWxlbiwKICAgICAgLmluY250ID0gMCwKICAgICAgLmJpdGJ1
ZiA9IDAsCiAgICAgIC5iaXRjbnQgPSAwLAogIH07CiAgaW50IGVycjsKICBpZiAoc2V0am1w
KHMuZW52KSAhPSAwKQogICAgZXJyID0gMjsKICBlbHNlIHsKICAgIGludCBsYXN0OwogICAg
ZG8gewogICAgICBsYXN0ID0gcHVmZl9iaXRzKCZzLCAxKTsKICAgICAgaW50IHR5cGUgPSBw
dWZmX2JpdHMoJnMsIDIpOwogICAgICBlcnIgPSB0eXBlID09IDAgPyBwdWZmX3N0b3JlZCgm
cykKICAgICAgICAgICAgICAgICAgICAgIDogKHR5cGUgPT0gMSA/IHB1ZmZfZml4ZWQoJnMp
CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgOiAodHlwZSA9PSAyID8gcHVm
Zl9keW5hbWljKCZzKSA6IC0xKSk7CiAgICAgIGlmIChlcnIgIT0gMCkKICAgICAgICBicmVh
azsKICAgIH0gd2hpbGUgKCFsYXN0KTsKICB9CiAgKmRlc3RsZW4gPSBzLm91dGNudDsKICBy
ZXR1cm4gZXJyOwp9CgovLyUgRU5EIENPREUgREVSSVZFRCBGUk9NIHB1ZmYue2MsaH0KCiNk
ZWZpbmUgWkxJQl9IRUFERVJfV0lEVEggMgoKc3RhdGljIGludCBwdWZmX3psaWJfdG9fZmls
ZShjb25zdCB1bnNpZ25lZCBjaGFyKiBzb3VyY2UsCiAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgdW5zaWduZWQgbG9uZyBzb3VyY2VsZW4sIGludCBkZXN0X2ZkKQp7CiAgaWYgKHNv
dXJjZWxlbiA8IFpMSUJfSEVBREVSX1dJRFRIKQogICAgcmV0dXJuIDA7CiAgc291cmNlICs9
IFpMSUJfSEVBREVSX1dJRFRIOwogIHNvdXJjZWxlbiAtPSBaTElCX0hFQURFUl9XSURUSDsK
ICBjb25zdCB1bnNpZ25lZCBsb25nIG1heF9kZXN0bGVuID0gMTMyIDw8IDIwOwogIHZvaWQq
IHJldCA9IG1tYXAoMCwgbWF4X2Rlc3RsZW4sIFBST1RfV1JJVEUgfCBQUk9UX1JFQUQsCiAg
ICAgICAgICAgICAgICAgICBNQVBfUFJJVkFURSB8IE1BUF9BTk9OLCAtMSwgMCk7CiAgaWYg
KHJldCA9PSBNQVBfRkFJTEVEKQogICAgcmV0dXJuIC0xOwogIHVuc2lnbmVkIGNoYXIqIGRl
c3QgPSAodW5zaWduZWQgY2hhciopcmV0OwogIHVuc2lnbmVkIGxvbmcgZGVzdGxlbiA9IG1h
eF9kZXN0bGVuOwogIGludCBlcnIgPSBwdWZmKGRlc3QsICZkZXN0bGVuLCBzb3VyY2UsIHNv
dXJjZWxlbik7CiAgaWYgKGVycikgewogICAgbXVubWFwKGRlc3QsIG1heF9kZXN0bGVuKTsK
ICAgIGVycm5vID0gLWVycjsKICAgIHJldHVybiAtMTsKICB9CiAgaWYgKHdyaXRlKGRlc3Rf
ZmQsIGRlc3QsIGRlc3RsZW4pICE9IChzc2l6ZV90KWRlc3RsZW4pIHsKICAgIG11bm1hcChk
ZXN0LCBtYXhfZGVzdGxlbik7CiAgICByZXR1cm4gLTE7CiAgfQogIHJldHVybiBtdW5tYXAo
ZGVzdCwgbWF4X2Rlc3RsZW4pOwp9CgpzdGF0aWMgaW50IHNldHVwX2xvb3BfZGV2aWNlKHVu
c2lnbmVkIGNoYXIqIGRhdGEsIHVuc2lnbmVkIGxvbmcgc2l6ZSwKICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICBjb25zdCBjaGFyKiBsb29wbmFtZSwgaW50KiBsb29wZmRfcCkKewog
IGludCBlcnIgPSAwLCBsb29wZmQgPSAtMTsKICBpbnQgbWVtZmQgPSBzeXNjYWxsKF9fTlJf
bWVtZmRfY3JlYXRlLCAic3l6a2FsbGVyIiwgMCk7CiAgaWYgKG1lbWZkID09IC0xKSB7CiAg
ICBlcnIgPSBlcnJubzsKICAgIGdvdG8gZXJyb3I7CiAgfQogIGlmIChwdWZmX3psaWJfdG9f
ZmlsZShkYXRhLCBzaXplLCBtZW1mZCkpIHsKICAgIGVyciA9IGVycm5vOwogICAgZ290byBl
cnJvcl9jbG9zZV9tZW1mZDsKICB9CiAgbG9vcGZkID0gb3Blbihsb29wbmFtZSwgT19SRFdS
KTsKICBpZiAobG9vcGZkID09IC0xKSB7CiAgICBlcnIgPSBlcnJubzsKICAgIGdvdG8gZXJy
b3JfY2xvc2VfbWVtZmQ7CiAgfQogIGlmIChpb2N0bChsb29wZmQsIExPT1BfU0VUX0ZELCBt
ZW1mZCkpIHsKICAgIGlmIChlcnJubyAhPSBFQlVTWSkgewogICAgICBlcnIgPSBlcnJubzsK
ICAgICAgZ290byBlcnJvcl9jbG9zZV9sb29wOwogICAgfQogICAgaW9jdGwobG9vcGZkLCBM
T09QX0NMUl9GRCwgMCk7CiAgICB1c2xlZXAoMTAwMCk7CiAgICBpZiAoaW9jdGwobG9vcGZk
LCBMT09QX1NFVF9GRCwgbWVtZmQpKSB7CiAgICAgIGVyciA9IGVycm5vOwogICAgICBnb3Rv
IGVycm9yX2Nsb3NlX2xvb3A7CiAgICB9CiAgfQogIGNsb3NlKG1lbWZkKTsKICAqbG9vcGZk
X3AgPSBsb29wZmQ7CiAgcmV0dXJuIDA7CgplcnJvcl9jbG9zZV9sb29wOgogIGNsb3NlKGxv
b3BmZCk7CmVycm9yX2Nsb3NlX21lbWZkOgogIGNsb3NlKG1lbWZkKTsKZXJyb3I6CiAgZXJy
bm8gPSBlcnI7CiAgcmV0dXJuIC0xOwp9CgpzdGF0aWMgdm9pZCByZXNldF9sb29wX2Rldmlj
ZShjb25zdCBjaGFyKiBsb29wbmFtZSkKewogIGludCBsb29wZmQgPSBvcGVuKGxvb3BuYW1l
LCBPX1JEV1IpOwogIGlmIChsb29wZmQgPT0gLTEpIHsKICAgIHJldHVybjsKICB9CiAgaWYg
KGlvY3RsKGxvb3BmZCwgTE9PUF9DTFJfRkQsIDApKSB7CiAgfQogIGNsb3NlKGxvb3BmZCk7
Cn0KCnN0YXRpYyBsb25nIHN5el9tb3VudF9pbWFnZSh2b2xhdGlsZSBsb25nIGZzYXJnLCB2
b2xhdGlsZSBsb25nIGRpciwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZvbGF0aWxl
IGxvbmcgZmxhZ3MsIHZvbGF0aWxlIGxvbmcgb3B0c2FyZywKICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIHZvbGF0aWxlIGxvbmcgY2hhbmdlX2RpciwKICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIHZvbGF0aWxlIHVuc2lnbmVkIGxvbmcgc2l6ZSwgdm9sYXRpbGUgbG9uZyBp
bWFnZSkKewogIHVuc2lnbmVkIGNoYXIqIGRhdGEgPSAodW5zaWduZWQgY2hhciopaW1hZ2U7
CiAgaW50IHJlcyA9IC0xLCBlcnIgPSAwLCBuZWVkX2xvb3BfZGV2aWNlID0gISFzaXplOwog
IGNoYXIqIG1vdW50X29wdHMgPSAoY2hhciopb3B0c2FyZzsKICBjaGFyKiB0YXJnZXQgPSAo
Y2hhciopZGlyOwogIGNoYXIqIGZzID0gKGNoYXIqKWZzYXJnOwogIGNoYXIqIHNvdXJjZSA9
IE5VTEw7CiAgY2hhciBsb29wbmFtZVs2NF07CiAgaWYgKG5lZWRfbG9vcF9kZXZpY2UpIHsK
ICAgIGludCBsb29wZmQ7CiAgICBtZW1zZXQobG9vcG5hbWUsIDAsIHNpemVvZihsb29wbmFt
ZSkpOwogICAgc25wcmludGYobG9vcG5hbWUsIHNpemVvZihsb29wbmFtZSksICIvZGV2L2xv
b3AlbGx1IiwgcHJvY2lkKTsKICAgIGlmIChzZXR1cF9sb29wX2RldmljZShkYXRhLCBzaXpl
LCBsb29wbmFtZSwgJmxvb3BmZCkgPT0gLTEpCiAgICAgIHJldHVybiAtMTsKICAgIGNsb3Nl
KGxvb3BmZCk7CiAgICBzb3VyY2UgPSBsb29wbmFtZTsKICB9CiAgbWtkaXIodGFyZ2V0LCAw
Nzc3KTsKICBjaGFyIG9wdHNbMjU2XTsKICBtZW1zZXQob3B0cywgMCwgc2l6ZW9mKG9wdHMp
KTsKICBpZiAoc3RybGVuKG1vdW50X29wdHMpID4gKHNpemVvZihvcHRzKSAtIDMyKSkgewog
IH0KICBzdHJuY3B5KG9wdHMsIG1vdW50X29wdHMsIHNpemVvZihvcHRzKSAtIDMyKTsKICBp
ZiAoc3RyY21wKGZzLCAiaXNvOTY2MCIpID09IDApIHsKICAgIGZsYWdzIHw9IE1TX1JET05M
WTsKICB9IGVsc2UgaWYgKHN0cm5jbXAoZnMsICJleHQiLCAzKSA9PSAwKSB7CiAgICBib29s
IGhhc19yZW1vdW50X3JvID0gZmFsc2U7CiAgICBjaGFyKiByZW1vdW50X3JvX3N0YXJ0ID0g
c3Ryc3RyKG9wdHMsICJlcnJvcnM9cmVtb3VudC1ybyIpOwogICAgaWYgKHJlbW91bnRfcm9f
c3RhcnQgIT0gTlVMTCkgewogICAgICBjaGFyIGFmdGVyID0gKihyZW1vdW50X3JvX3N0YXJ0
ICsgc3RybGVuKCJlcnJvcnM9cmVtb3VudC1ybyIpKTsKICAgICAgY2hhciBiZWZvcmUgPSBy
ZW1vdW50X3JvX3N0YXJ0ID09IG9wdHMgPyAnXDAnIDogKihyZW1vdW50X3JvX3N0YXJ0IC0g
MSk7CiAgICAgIGhhc19yZW1vdW50X3JvID0gKChiZWZvcmUgPT0gJ1wwJyB8fCBiZWZvcmUg
PT0gJywnKSAmJgogICAgICAgICAgICAgICAgICAgICAgICAoYWZ0ZXIgPT0gJ1wwJyB8fCBh
ZnRlciA9PSAnLCcpKTsKICAgIH0KICAgIGlmIChzdHJzdHIob3B0cywgImVycm9ycz1wYW5p
YyIpIHx8ICFoYXNfcmVtb3VudF9ybykKICAgICAgc3RyY2F0KG9wdHMsICIsZXJyb3JzPWNv
bnRpbnVlIik7CiAgfSBlbHNlIGlmIChzdHJjbXAoZnMsICJ4ZnMiKSA9PSAwKSB7CiAgICBz
dHJjYXQob3B0cywgIixub3V1aWQiKTsKICB9IGVsc2UgaWYgKHN0cm5jbXAoZnMsICJnZnMy
IiwgNCkgPT0gMCAmJgogICAgICAgICAgICAgKHN0cnN0cihvcHRzLCAiZXJyb3JzPXBhbmlj
IikgfHwgc3Ryc3RyKG9wdHMsICJkZWJ1ZyIpKSkgewogICAgc3RyY2F0KG9wdHMsICIsZXJy
b3JzPXdpdGhkcmF3Iik7CiAgfQogIHJlcyA9IG1vdW50KHNvdXJjZSwgdGFyZ2V0LCBmcywg
ZmxhZ3MsIG9wdHMpOwogIGlmIChyZXMgPT0gLTEpIHsKICAgIGVyciA9IGVycm5vOwogICAg
Z290byBlcnJvcl9jbGVhcl9sb29wOwogIH0KICByZXMgPSBvcGVuKHRhcmdldCwgT19SRE9O
TFkgfCBPX0RJUkVDVE9SWSk7CiAgaWYgKHJlcyA9PSAtMSkgewogICAgZXJyID0gZXJybm87
CiAgICBnb3RvIGVycm9yX2NsZWFyX2xvb3A7CiAgfQogIGlmIChjaGFuZ2VfZGlyKSB7CiAg
ICByZXMgPSBjaGRpcih0YXJnZXQpOwogICAgaWYgKHJlcyA9PSAtMSkgewogICAgICBlcnIg
PSBlcnJubzsKICAgIH0KICB9CgplcnJvcl9jbGVhcl9sb29wOgogIGlmIChuZWVkX2xvb3Bf
ZGV2aWNlKQogICAgcmVzZXRfbG9vcF9kZXZpY2UobG9vcG5hbWUpOwogIGVycm5vID0gZXJy
OwogIHJldHVybiByZXM7Cn0KCnVpbnQ2NF90IHJbNF0gPSB7MHhmZmZmZmZmZmZmZmZmZmZm
LCAweGZmZmZmZmZmZmZmZmZmZmYsIDB4ZmZmZmZmZmZmZmZmZmZmZiwKICAgICAgICAgICAg
ICAgICAweGZmZmZmZmZmZmZmZmZmZmZ9OwoKaW50IG1haW4odm9pZCkKewogIHN5c2NhbGwo
X19OUl9tbWFwLCAvKmFkZHI9Ki8weDFmZmZmZmZmZjAwMHVsLCAvKmxlbj0qLzB4MTAwMHVs
LCAvKnByb3Q9Ki8wdWwsCiAgICAgICAgICAvKmZsYWdzPU1BUF9GSVhFRHxNQVBfQU5PTllN
T1VTfE1BUF9QUklWQVRFKi8gMHgzMnVsLAogICAgICAgICAgLypmZD0qLyhpbnRwdHJfdCkt
MSwgLypvZmZzZXQ9Ki8wdWwpOwogIHN5c2NhbGwoX19OUl9tbWFwLCAvKmFkZHI9Ki8weDIw
MDAwMDAwMDAwMHVsLCAvKmxlbj0qLzB4MTAwMDAwMHVsLAogICAgICAgICAgLypwcm90PVBS
T1RfV1JJVEV8UFJPVF9SRUFEfFBST1RfRVhFQyovIDd1bCwKICAgICAgICAgIC8qZmxhZ3M9
TUFQX0ZJWEVEfE1BUF9BTk9OWU1PVVN8TUFQX1BSSVZBVEUqLyAweDMydWwsCiAgICAgICAg
ICAvKmZkPSovKGludHB0cl90KS0xLCAvKm9mZnNldD0qLzB1bCk7CiAgc3lzY2FsbChfX05S
X21tYXAsIC8qYWRkcj0qLzB4MjAwMDAxMDAwMDAwdWwsIC8qbGVuPSovMHgxMDAwdWwsIC8q
cHJvdD0qLzB1bCwKICAgICAgICAgIC8qZmxhZ3M9TUFQX0ZJWEVEfE1BUF9BTk9OWU1PVVN8
TUFQX1BSSVZBVEUqLyAweDMydWwsCiAgICAgICAgICAvKmZkPSovKGludHB0cl90KS0xLCAv
Km9mZnNldD0qLzB1bCk7CiAgY29uc3QgY2hhciogcmVhc29uOwogICh2b2lkKXJlYXNvbjsK
ICBpbnRwdHJfdCByZXMgPSAwOwogIGlmICh3cml0ZSgxLCAiZXhlY3V0aW5nIHByb2dyYW1c
biIsIHNpemVvZigiZXhlY3V0aW5nIHByb2dyYW1cbiIpIC0gMSkpIHsKICB9CiAgLy8gIHN5
el9tb3VudF9pbWFnZSRoZnNwbHVzIGFyZ3VtZW50czogWwogIC8vICAgIGZzOiBwdHJbaW4s
IGJ1ZmZlcl0gewogIC8vICAgICAgYnVmZmVyOiB7NjggNjYgNzMgNzAgNmMgNzUgNzMgMDB9
IChsZW5ndGggMHg4KQogIC8vICAgIH0KICAvLyAgICBkaXI6IHB0cltpbiwgYnVmZmVyXSB7
CiAgLy8gICAgICBidWZmZXI6IHsyZSAyZiA2NiA2OSA2YyA2NSAzMSAwMH0gKGxlbmd0aCAw
eDgpCiAgLy8gICAgfQogIC8vICAgIGZsYWdzOiBtb3VudF9mbGFncyA9IDB4YzAwYSAoOCBi
eXRlcykKICAvLyAgICBvcHRzOiBwdHJbaW5vdXQsIGFycmF5W0FOWVVOSU9OXV0gewogIC8v
ICAgICAgYXJyYXlbQU5ZVU5JT05dIHsKICAvLyAgICAgIH0KICAvLyAgICB9CiAgLy8gICAg
Y2hkaXI6IGludDggPSAweDExICgxIGJ5dGVzKQogIC8vICAgIHNpemU6IGxlbiA9IDB4NmMy
ICg4IGJ5dGVzKQogIC8vICAgIGltZzogcHRyW2luLCBidWZmZXJdIHsKICAvLyAgICAgIGJ1
ZmZlcjogKGNvbXByZXNzZWQgYnVmZmVyIHdpdGggbGVuZ3RoIDB4NmMyKQogIC8vICAgIH0K
ICAvLyAgXQogIC8vICByZXR1cm5zIGZkX2RpcgogIG1lbWNweSgodm9pZCopMHgyMDAwMDAw
MDAxODAsICJoZnNwbHVzXDAwMCIsIDgpOwogIG1lbWNweSgodm9pZCopMHgyMDAwMDAwMDE0
ODAsICIuL2ZpbGUxXDAwMCIsIDgpOwogIG1lbWNweSgKICAgICAgKHZvaWQqKTB4MjAwMDAw
MDAwYWMwLAogICAgICAiXHg3OFx4OWNceGVjXHhkZFx4Y2RceDZmXHgxY1x4NjdceDFkXHgw
N1x4ZjBceGVmXHhhY1x4ZDdceDJmXHg5Ylx4NGFceGFlIgogICAgICAiXHhmYlx4MWVceDUw
XHhhNVx4OWFceDQ2XHgyYVx4ODhceDg4XHgyNlx4OGVceDk1XHg0Mlx4YjhceDI0XHgyMFx4
ODRceDgyIgogICAgICAiXHg1NFx4YTFceDJhXHgxY1x4MzhceDViXHhjNFx4NjlceGFjXHg2
Y1x4ZDJceGUwXHhiOFx4MjhceGVkXHg4MVx4YjhceDgwIgogICAgICAiXHhjNFx4OTVceDAz
XHg3Zlx4NDBceDM5XHg4NFx4MGJceDljXHg0MFx4MDhceDA5XHgwOVx4MjlceDUyXHgzOVx4
YzNceGFkIgogICAgICAiXHhlMlx4NjZceDcxXHhhYVx4ODRceGQ0XHg0Ylx4NGZceDY5XHgw
Zlx4MGNceDlhXHhkOVx4NTlceDdiXHhlZFx4ZWVceGRhIgogICAgICAiXHg5Ylx4NDRceGM5
XHgzYVx4ZjBceGY5XHg1OFx4YjNceGYzXHgzY1x4ZjNceGNjXHgzY1x4ZjNceDliXHhkZlx4
YmNceGVkIgogICAgICAiXHhhZVx4YjVceDlhXHgwMFx4ZmZceGI3XHhjZVx4MWZceDRmXHhm
Ylx4NGVceDNhXHgzOVx4N2ZceGZjXHhmNVx4OWJceDU1IgogICAgICAiXHg3ZFx4ZWJceGY2
XHg3Mlx4NzdceGViXHhmNlx4ZjJceGQ1XHg1ZVx4YjlceGQ1XHg0ZFx4MzJceDliXHhhNFx4
OTVceGI0IgogICAgICAiXHg3Ylx4YTNceDE0XHhkN1x4OTJceGUyXHg4M1x4ZTRceDVjXHg3
YVx4NDNceGJlXHg1MFx4NGRceDZjXHhiYVx4MmJceDQ2IgogICAgICAiXHhhZFx4ZTdceGQ3
XHg2Ylx4NjdceDJlXHg3Y1x4ZjhceGM5XHhkNlx4NDdceGJkXHg1YVx4M2JceDNiXHhmZFx4
NTVceDJmIgogICAgICAiXHg5ZFx4ZDFceDAxXHhiNlx4YzdceGQ5XHg4YVx4Y2RceDY2XHhj
OFx4NjJceDkyXHhhOVx4NjZceGZjXHgwMFx4NzZceGY1IgogICAgICAiXHhmN1x4YTNceGZi
XHhlYlx4NmZceDc2XHhhN1x4NThceDZjXHg2N1x4YTZceDRhXHhkOFx4YjFceDdlXHhlMlx4
NjBceGQyIgogICAgICAiXHhhNlx4OTNceDk0XHhiYlx4ZmNceGY4XHhmOVx4OWRceDk2XHg2
MVx4Y2FceGE5XHg4MVx4Y2FceGM4XHhmM1x4MWRceDc4IgogICAgICAiXHg3Y1x4MTRceGJk
XHhmYlx4ZTZceDgwXHhkZVx4ZjlceGJmXHg5MFx4MWNceDQ5XHgzMlx4ZDdceGJmXHhhMVx4
NmRceGY2IgogICAgICAiXHgxYVx4NWJceDhmXHgzZVx4YzJceDAzXHhkZFx4ZDNceGI1XHg2
OFx4ZjNceGUxXHhjNVx4MDFceDAwXHgwMFx4MDBceDg3IgogICAgICAiXHhjNlx4OTNceDc3
XHg2Zlx4MjVceDM3XHgzM1x4M2ZceGU5XHgzOFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4
MDBceDAwIgogICAgICAiXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgw
MFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwIgogICAgICAiXHgwMFx4ZTBceDcx
XHhkMlx4M2NceGZmXHhiZlx4NjhceDg2XHg1Nlx4YmZceGJjXHg5OFx4YTJceGZmXHhmY1x4
ZmZceDk5IgogICAgICAiXHg4MVx4NjdceGVjXHhjZlx4NGNceDM4XHhkY1x4ZDFceGY2XHg4
Zlx4NmNceGFlXHg1Zlx4YjhceGQzXHg3YVx4MTRceGMxIgogICAgICAiXHgwMFx4MDBceDAw
XHgwMFx4MDBceDAwXHgwMFx4YzBceGMzXHhmNVx4ZDJceGRkXHhmY1x4ZWVceDQyXHg1OVx4
Y2VceGY3IgogICAgICAiXHhlYlx4NjVceDUxXHhmZlx4Y2ZceGZmXHhlNVx4YmFceGYyXHg2
Y1x4ZmRceGZhXHg0NFx4ZGVceGNlXHg4ZFx4YWNceDY2IgogICAgICAiXHgzZFx4YWZceGU2
XHg2Nlx4NTZceGIyXHg5MVx4OGRceGFjXHg2N1x4MjlceGM5XHhjMlx4NDBceDQ3XHgzM1x4
MzdceDU3IgogICAgICAiXHgzNlx4MzZceGQ2XHg5N1x4ZmFceDRiXHg3ZVx4NTZceDk2XHhl
NVx4ODhceDI1XHg0Zlx4ZWRceGZjXHhmN1x4N2RceDYwIgogICAgICAiXHhjOVx4NTNceDYz
XHgwNlx4ZGNceDc5XHhmMFx4NmRceDA2XHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHg4MFx4
ZmZceDIxIgogICAgICAiXHg2N1x4OWJceGYxXHhjZlx4NzJceDNlXHhmM1x4MTNceDhlXHgw
NVx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwIgogICAgICAiXHgwMFx4MDBceDAw
XHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4
MDBceDAwIgogICAgICAiXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgw
MFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwIgogICAgICAiXHgwMFx4MDBceDAw
XHg3Nlx4MjlceDkyXHhhOVx4ZGVceGE4XHgxZVx4OWVceGVkXHg5N1x4MTdceGQyXHg2YVx4
MjdceDk5IgogICAgICAiXHg0Ylx4MzJceDUzXHhjZFx4YjdceDk5XHhmY1x4YTNceDVmXHg3
ZVx4OWNceGRkXHg5OVx4NzRceDAwXHgwMFx4MDBceDAwIgogICAgICAiXHhmMFx4MDhceDNj
XHg3OVx4MzdceDc3XHg3M1x4MzNceGYzXHhmZFx4N2FceDU5XHhkNFx4OWZceGY5XHg5Zlx4
YWZceDNmIgogICAgICAiXHhmN1x4Y2ZceGU1XHhlZFx4NWNceGNiXHg0Nlx4ZDZceGIyXHg5
MVx4NmVceDU2XHg3M1x4YjFceGZlXHgyZVx4YTBceGY3IgogICAgICAiXHhhOVx4YmZceGI1
XHg3NVx4N2JceGI5XHhiYlx4NzVceDdiXHhmOVx4NmFceDM1XHg3Y1x4YmVceGRmXHg2Zlx4
N2RceGJjIgogICAgICAiXHg1M1x4ZmVceGUzXHhmY1x4ODFceDYxXHhkNFx4M2RceGE2XHhm
N1x4ZGRceGMzXHhmMFx4MzVceDFmXHhhZFx4ZTdceGU4IgogICAgICAiXHhlNFx4NTJceGQ2
XHg5YVx4YjlceDkyXHhiN1x4ZDJceGNkXHhjNVx4YjRceGVhXHgyNVx4MmJceDQ3XHhmYlx4
ZjFceDBjIgogICAgICAiXHg4Zlx4ZWJceGJkXHhmYVx4OWJceDhkXHhiM1x4M2RceDY1XHg5
OVx4ZDlceDcxXHgxMlx4NzRceGIxXHgxOVx4NTdceDViIgogICAgICAiXHhmZVx4YWJceDY2
XHg3Y1x4MzhceDJjXHhkNFx4MTlceDk5XHhhZVx4MzNceDUyXHhlNVx4ZThceDY0XHgxM1x4
NWJceDk1IgogICAgICAiXHg4ZFx4YTdceGY2XHhjZlx4YzRceGUwXHhkZVx4YjlceDhmXHgz
NVx4MmRceGE1XHhiNVx4ZmRceGNkXHhjZlx4NWNceDMzIgogICAgICAiXHgxZVx4OTVceGYz
XHg4Zlx4MDdceDcyXHg3ZVx4NzZceGRmXHhiNVx4MTRceGZmXHgyOVx4Y2JceDVlXHhlOVx4
NDhceDdmIgogICAgICAiXHg0YVx4ZjJceGM0XHhmN1x4MGVceGNlXHhmOVx4ZjRceDNkXHg2
ZFx4Y2NceDAzXHhkOVx4OWJceDg5XHg1M1x4MDNceDQ3IgogICAgICAiXHhkZlx4ZjNceGZi
XHhlN1x4M2NceGY5XHhmMlx4OWZceDdlXHhmZlx4YzNceGNiXHhkZFx4NmJceDU3XHgyZVx4
MTdceDliIgogICAgICAiXHhjN1x4MGZceGNmXHg2MVx4MzRceGNjXHg0Ylx4YzNceDI3XHhj
Zlx4ZmVceGFiXHhiZlx4ODdceGZhXHg5OVx4ZThceGQ5IgogICAgICAiXHhjY1x4NmFceDk2
XHgwN1x4MzJceGYxXHg0Mlx4OTNceDgxXHhhOVx4ZmVceDcxXHhiMVx4YjdceGEzXHhlZFx4
NGNceDVjIgogICAgICAiXHhiYVx4NzFceGM4XHgzM1x4MzFceGE2XHg1Nlx4OWVceGRiXHgy
ZVx4OWZceGNmXHg3N1x4ZjNceDgzXHgxY1x4Y2ZceDYyIgogICAgICAiXHhkZVx4YzhceDdh
XHhkNlx4ZjJceDkzXHhhY1x4NjRceDIzXHhhYlx4NTlceGNjXHg3N1x4ZWFceGQyXHg0YVx4
NzNceDNjIgogICAgICAiXHg1N1x4YWZceDBiXHhmYlx4MWZceDMzXHhlN1x4NzZceGQ1XHhk
ZVx4MzhceDI4XHg4YVx4OTlceDY2XHhiZlx4NGNceGVkIgogICAgICAiXHg4OVx4ZTlceDRi
XHg0Zlx4ZjZceGM2XHhmYlx4YzVceGY0XHg3Mlx4YmRceGVjXHg3Y1x4ZDZceGYyXHhmZFx4
YmNceDk1IgogICAgICAiXHg4Ylx4NTlceGNkXHg2Ylx4ZjVceGRmXHhhOVx4MmNceGU1XHhl
Ylx4MzlceDlkXHhkM1x4MzlceDMzXHhiMFx4ODdceDlmIgogICAgICAiXHgzYlx4ZTBceDRh
XHg1Ylx4OWRceGY1XHhhZFx4MjFceDY3XHhmZFx4OWZceDQ3XHgwN1x4N2ZceGVjXHgyYlx4
NGRceGExIgogICAgICAiXHg5M1x4ZTRceDk3XHhjZFx4ZjhceDcwXHhhOFx4ZjJceGZhXHhk
NFx4NDBceDVlXHgwN1x4YWZceGI5XHgwYlx4NzVceGRiIgogICAgICAiXHhlMFx4OTRceDU2
XHhjYVx4ZTZceGNlXHhmMlx4ZjRceDE4XHg1OVx4MWFceGVmXHhkYVx4OThceDk0XHg2NVx4
ZWZceGRjIgogICAgICAiXHhmYlx4NjJceDUzXHhhZlx4ZjZceGM0XHhjZlx4MDdceGNlXHhj
MVx4YzlceGRiXHhjZVx4YzRceDVjXHhiNlx4ZWZceDEyIgogICAgICAiXHhmZFx4ZThceDll
XHhlOVx4NjdceDYwXHg3YVx4NjhceDI2XHg3ZVx4NTNceDZmXHhkYVx4OGRceGVlXHhiNVx4
MmJceGViIgogICAgICAiXHg5N1x4NTdceGFlXHhlZlx4ZTlceGI3XHhkOFx4MWNceGJlXHhi
ZVx4NTdceGIyXHg3Ylx4ZjNceDBmXHhjZlx4ODVceGE0IgogICAgICAiXHgzYVx4NWVceDll
XHg0ZVx4ZDJceGFlXHg2Ylx4YmJceDhmXHg4ZVx4YWFceGVkXHg5OVx4YTFceDZkXHg0Ylx4
NzVceGRiIgogICAgICAiXHhiM1x4ZGJceDZkXHhhZFx4YmRceDZkXHhiZlx4ZWRceDZjXHhi
N1x4MWRceDc0XHhhNlx4Y2VceDM0XHhlZlx4ZTFceDNlIgogICAgICAiXHhkZlx4ZDNceGE5
XHhiYVx4ZWRceDg1XHhhMVx4NmRceGNiXHg3NVx4ZGJceGQxXHg4MVx4YjZceGVhXHhmZFx4
NTZceDc1IgogICAgICAiXHg4N1x4NWZceGNkXHg2N1x4NjVceDU5XHhmNlx4ZGVceDZmXHgw
MVx4NzBceGU4XHgxZFx4ZjlceGVhXHg5MVx4OTlceGNlIgogICAgICAiXHhiZlx4M2JceDdm
XHhlZlx4YmNceGRmXHhmOVx4NDVceGU3XHg3Mlx4ZTdceGY1XHhiOVx4NmZceGNmXHg3ZVx4
NjNceGY2IgogICAgICAiXHhjNVx4OTlceDRjXHhmZlx4NmRceGZhXHg5Ylx4ZWRceDkzXHg1
M1x4YWZceGI0XHg1ZVx4MmNceGZlXHg5MFx4ZjdceGYzIgogICAgICAiXHhkM1x4MWNceGZj
XHgwOVx4MWRceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4
MDBceDAwIgogICAgICAiXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgw
MFx4MzhceGQwXHg4ZFx4NzdceGRlXHhiZFx4YjJceGQyIgogICAgICAiXHhlZFx4YWVceGFl
XHhlZlx4MjlceDk0XHg2NVx4NzlceDZiXHg0NFx4ZDNceDQzXHgyOVx4YTRceDlkXHhlY1x4
OWFceGYyIgogICAgICAiXHhkN1x4YmZceDM0XHg4NVx4ZTZceDI5XHg2Zlx4ZjVceGMzXHg4
MFx4YzZceGVmXHhiMFx4OWFceGZiXHg1Y1x4MmJceGE5IgogICAgICAiXHhhN1x4YjRceGQz
XHgxNFx4ZWVceDJkXHhiMFx4NWJceGY3XHhiN1x4MzlceGVmXHhkZFx4NmZceDEyXHhmZVx4
ZDlceGVjIgogICAgICAiXHg5M1x4NWRceDRkXHhmNVx4NTNceDc4XHgxZVx4YzlceDJlXHhi
OFx4OGZceGMyXHhkY1x4YzhceGUzXHg2N1x4NmZceGUxIgogICAgICAiXHhkM1x4YjJceDJj
XHgwZlx4NDdceGNjXHhlM1x4MTRceGNhXHhjNlx4NjFceDg5XHg2N1x4MTJceDg1XHhjOVx4
NWRceDkzIgogICAgICAiXHg4MFx4NDdceGUzXHhjNFx4YzZceGQ1XHhlYlx4MjdceDZlXHhi
Y1x4ZjNceGVlXHhkN1x4ZDZceGFlXHhiNlx4ZGVceDVjIgogICAgICAiXHg3ZFx4NzNceGY1
XHhkYVx4OTlceGQzXHhhN1x4Y2ZceDljXHgzY1x4NzNceGZhXHhiNVx4ZTVceDEzXHg5N1x4
ZDZceGJhIgogICAgICAiXHg3M1x4OTNceDBlXHgwZlx4NzhceDg4XHhlYVx4N2JceDdkXHhm
ZFx4M2VceDY3XHhkMlx4OTFceDAwXHgwMFx4MDBceDAwIgogICAgICAiXHgwMFx4MDBceDAw
XHgwMFx4MDBceDAwXHhlM1x4MWFceGVmXHhjN1x4MzlceGM1XHg4M1x4ZmRceGI2XHgwN1x4
MDBceDAwIgogICAgICAiXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgw
MFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwIgogICAgICAiXHgwMFx4MDBceDAw
XHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4
MDBceDAwIgogICAgICAiXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgw
MFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwIgogICAgICAiXHgwMFx4MDBceDAw
XHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4
MDBceDAwIgogICAgICAiXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgw
MFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwIgogICAgICAiXHgwMFx4MDBceDAw
XHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4
MDBceDAwIgogICAgICAiXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgw
MFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwIgogICAgICAiXHgwMFx4MDBceDAw
XHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4
MDBceDAwIgogICAgICAiXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgw
MFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwIgogICAgICAiXHgwMFx4MDBceDAw
XHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4
MDBceDAwIgogICAgICAiXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgw
MFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwIgogICAgICAiXHgwMFx4MDBceDAw
XHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4
MDBceDAwIgogICAgICAiXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgw
MFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwIgogICAgICAiXHgwMFx4MDBceDAw
XHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4
MDBceDAwIgogICAgICAiXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgw
MFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwIgogICAgICAiXHgwMFx4MDBceDAw
XHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4
MDBceDAwIgogICAgICAiXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgw
MFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwIgogICAgICAiXHgwMFx4MDBceDAw
XHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4
MDBceDAwIgogICAgICAiXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgw
MFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwIgogICAgICAiXHgwMFx4MDBceDAw
XHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4
MDBceDAwIgogICAgICAiXHgwMFx4ZTBceDAxXHg5Y1x4M2ZceDllXHhmNlx4OWRceDE0XHg1
OVx4M2FceGY5XHhlYVx4YzlceGFhXHhiZVx4NzVceDdiIgogICAgICAiXHhiOVx4NWJceDBk
XHhmZFx4ZjJceGNlXHg5Y1x4OWZceDI2XHg2OVx4MjVceDI5XHgxNlx4OTNceGUyXHg4M1x4
ZTRceDVjIgogICAgICAiXHg3YVx4NDNceDE2XHgwNlx4YmFceDJiXHg0Nlx4YWRceDY3XHgz
M1x4YjlceGYwXHhlMVx4MjdceDViXHgxZlx4ZjVceDZhIgogICAgICAiXHhlZFx4NjZceGE4
XHhlN1x4NmZceGVkXHhiN1x4ZGNceDc4XHgzNlx4OWJceDIxXHg4Ylx4NDlceGE2XHg5YVx4
ZjFceDEwIgogICAgICAiXHg3M1x4NDlceDhlXHhlY1x4OWRceDU4XHhkZVx4MWFceGQ1XHg1
Zlx4NTFceGY3XHg3M1x4N2RceDc0XHg3Zlx4NjNceDJhIgogICAgICAiXHhiNlx4YjdceGIw
XHg0YVx4ZDhceGIxXHg3ZVx4ZTJceDYwXHhkMlx4ZmVceDFiXHgwMFx4MDBceGZmXHhmZlx4
YjRceDc0IgogICAgICAiXHgwZlx4MGMiLAogICAgICAxNzMwKTsKICByZXMgPSAtMTsKICBy
ZXMgPSBzeXpfbW91bnRfaW1hZ2UoLypmcz0qLzB4MjAwMDAwMDAwMTgwLCAvKmRpcj0qLzB4
MjAwMDAwMDAxNDgwLAogICAgICAgICAgICAgICAgICAgICAgICAvKmZsYWdzPU1TX1JFQ3xN
U19TSUxFTlR8TVNfTk9TVUlEfE1TX05PRVhFQyovIDB4YzAwYSwKICAgICAgICAgICAgICAg
ICAgICAgICAgLypvcHRzPSovMHgyMDAwMDAwMDAwNDAsIC8qY2hkaXI9Ki8weDExLCAvKnNp
emU9Ki8weDZjMiwKICAgICAgICAgICAgICAgICAgICAgICAgLyppbWc9Ki8weDIwMDAwMDAw
MGFjMCk7CiAgaWYgKHJlcyAhPSAtMSkKICAgIHJbMF0gPSByZXM7CiAgLy8gIG9wZW5hdCBh
cmd1bWVudHM6IFsKICAvLyAgICBmZDogZmRfZGlyIChyZXNvdXJjZSkKICAvLyAgICBmaWxl
OiBwdHJbaW4sIGJ1ZmZlcl0gewogIC8vICAgICAgYnVmZmVyOiB7MmUgMmYgNjYgNjkgNmMg
NjUgMzEgMDB9IChsZW5ndGggMHg4KQogIC8vICAgIH0KICAvLyAgICBmbGFnczogb3Blbl9m
bGFncyA9IDB4MTgzMDQyICg0IGJ5dGVzKQogIC8vICAgIG1vZGU6IG9wZW5fbW9kZSA9IDB4
OCAoMiBieXRlcykKICAvLyAgXQogIC8vICByZXR1cm5zIGZkCiAgbWVtY3B5KCh2b2lkKikw
eDIwMDAwMDAwMDA4MCwgIi4vZmlsZTFcMDAwIiwgOCk7CiAgcmVzID0gc3lzY2FsbChfX05S
X29wZW5hdCwgLypmZD0qLzB4ZmZmZmZmOWMsIC8qZmlsZT0qLzB4MjAwMDAwMDAwMDgwdWws
CiAgICAgICAgICAgICAgICAvKmZsYWdzPU9fU1lOQ3xPX0NSRUFUfE9fQ0xPRVhFQ3xGQVNZ
TkN8T19SRFdSKi8gMHgxODMwNDIsCiAgICAgICAgICAgICAgICAvKm1vZGU9U19JWEdSUCov
IDgpOwogIGlmIChyZXMgIT0gLTEpCiAgICByWzFdID0gcmVzOwogIHJldHVybiAwOwp9Cg==


--------------mUQdbcsdKCm0jM2cAkKW91iu--

